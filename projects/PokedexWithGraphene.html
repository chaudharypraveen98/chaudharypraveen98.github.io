<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="A project that is build on the top of the django and graphene(GraphQL - A query language for API) library. Used the django-extension to run script which loads data from json." />
        <title>Pokedex With Graphene</title>
        <meta name="keywords" content="chaudharypraveen98,Praveen Chaudhary,devilunknown, Praveen Chaudhary projects, PokedexWithGraphene">
        <meta name="robots" content="index, follow">
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
        <meta name="language" content="English">
        <meta name="revisit-after" content="2 days">
        <meta name="author" content="@chaudharypraveen98">
        <meta name="twitter:title" content="Praveen Chaudhary">
        <meta name="twitter:description" content=" Personal Projects Section">
        <meta name="twitter:image" content="https://pbs.twimg.com/profile_images/1366311960468332546/EidYygUt_400x400.jpg">
        <meta name="twitter:card" content="summary_large_image">
        <meta property="og:title" content="Praveen Chaudhary - a Full Stack Developer" />
        <meta property="og:url" content="https://www.linkedin.com/in/chaudharypraveen98/" />
        <meta property="og:description" content="This is the personal portfolio page which contains all the projects. I am a Full Stack Developer, Rest Api Developer, Data Analsyt" />
        <meta property="og:image" content="https://media-exp1.licdn.com/dms/image/C5603AQHRamUaMrdA9g/profile-displayphoto-shrink_400_400/0/1597315489941?e=1629936000&v=beta&t=GjvQu_r0n3F2EtGkaRYSF6pH8vRdgx5lsD1-w8dc8gY" />
        <meta property="og:type" content="Portfolio.Projects" />
        <link rel="shortcut icon" href="./../favicon.ico" type="image/x-icon">
        <!-- Font Awesome icons (free version)-->
        <script src="https://use.fontawesome.com/releases/v5.15.3/js/all.js" crossorigin="anonymous"></script>
        <!-- Google fonts-->
        <link href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <body>
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-light" id="mainNav">
            <div class="container px-4 px-lg-5">
                <a class="navbar-brand" href="index.html">PokedexWithGraphene</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    Menu
                    <i class="fas fa-bars"></i>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto py-4 py-lg-0">
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="index.html">Home</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="https://chaudharypraveen98.github.io/about.html">About</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="https://chaudharypraveen98.github.io/project-preview/">Latest Works</a></li>
                        <li class="nav-item"><a class="nav-link px-lg-3 py-3 py-lg-4" href="https://chaudharypraveen98.github.io/contact.html">Contact</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Page Header-->
        <header class="masthead" style="background-image: url('assets/img/post-bg.jpg')">
            <div class="container position-relative px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-md-10 col-lg-8 col-xl-7">
                        <div class="post-heading">
                            <h1>Pokedex With Graphene</h1>
                            <h2 class="subheading">A project that is build on the top of the django and graphene(GraphQL - A query language for API) library. Used the django-extension to run script which loads data from json.</h2>
                            <span class="meta">
                                Posted by
                                <a href="https://github.com/chaudharypraveen98">Praveen Chaudhary</a>
                                on 18 February 2021
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </header>
        <!-- Post Content-->
        <article class="mb-4">
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-md-10 col-lg-8 col-xl-7">
                        <h3>Topics -> graphql, django, ajax, webdevelopment, api</h3>
                        <h5>Preview Link -> <u><a href="https://raw.githubusercontent.com/chaudharypraveen98/PokedexWithGraphene/master/graphql3.JPG">PokedexWithGraphene</a></u></h5>
                        <h5>Source Code Link -> <u><a href="https://github.com/chaudharypraveen98/PokedexWithGraphene">GitHub</a></u></h5>
                        
                        <p><strong>What We are going to do?</strong></p>
                        <ol>
                            <li>Starting the Django Project</li>
                            <li>Creating a pokemon app within the PokedexWithGraphene Project</li>
                            <li>Create a Album and Song model in pokemon/models.py</li>
                            <li>Importing pokemon data from json file using  Django Extensions</li>
                            <li>Writing GraphQL queries and schema</li>
                            <li>Creating a view for handling the request made from the client</li>
                            <li>Adding function handlers to routes</li>
                            <li>Creating a Template for displaying the song data on the page</li>
                            <li>Fetching data using ajax into templates</li>
                        </ol>
                        <p><h3>Understanding Some Important Concepts</h3></p>
                        <p><strong>What is Django Framework?</strong></p>
                        <p>Django is a Python-based free and open-source web framework that follows the model–template–views architectural pattern.</p>
                        <p><b>Top Features of Django Framework</b></p>
                        <ul>
                            <li>Excellent Documentation</li>
                            <li>SEO Optimized</li>
                            <li>High Scalability</li>
                            <li>Versatile in Nature</li>
                            <li>Offers High Security</li>
                            <li>Provides Rapid Development</li>
                        </ul>


                        
                        <h2 class="section-heading">Step 1 => Starting the Django Project</h2>
                        <p>Initialize a Django project by following command. <b>Python</b> must be installed on your system.</p>
                        <pre>
pip install Django
</pre>
                        <p>You can confirm the installation by checking the django version by following command</p>
                        <pre>
python -m django --version
                        </pre>
                        <p><b>Starting the Project</b></p>
                        <pre>
django-admin startproject PokedexWithGraphene
                        </pre>
                        <p>You get the project structure like this</p>
                        <pre>
PokedexWithGraphene/
    manage.py
    PokedexWithGraphene/
        __init__.py
        settings.py
        urls.py
        asgi.py
        wsgi.py
                        </pre>



                        <h2 class="section-heading">Step 2 -> Creating a pokemon app within the PokedexWithGraphene Project</h2>
                        <p><strong>What is a Django App?</strong></p>
                        <p>An app is a Web application that does something – e.g., a Weblog system, a database of public records or a small poll app.</p> 
                        <p>A project is a collection of configuration and apps for a particular website. A project can contain multiple apps. An app can be in multiple projects.</p>
                        <p>Creating the pokemon app</p>
                        <pre>
python manage.py startapp pokemon
                        </pre>
                        <p>That’ll create a directory pokemon, which is laid out like this:</p>
                        <pre>
pokemon/
    __init__.py
    admin.py
    apps.py
    migrations/
        __init__.py
    models.py
    tests.py
    views.py
</pre>
                        <p><strong>Including your app and libraries in project</strong></p>
                        <pre>
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',

    # for loading data
    'django_extensions',

    # our main reusable components
    'pokemon.apps.PokemonConfig',

    # graphql library
    'graphene_django'
]
                        </pre>

                        <p><strong>Making migrations</strong></p>
                        <p>Once the model is defined, the django will automatically take schemas and table according to the fields supplied in the django model.</p>
                        <pre>
python manage.py makemigrations
python manage.py migrate
                        </pre>



                        <h2 class="section-heading">Step 3 -> Create a Pokemon and PokemonTag model in pokemon/models.py</h2>
                        <p><strong>What is a Django Model?</strong></p>
                        <p>A model is the single, definitive source of truth about your data. It contains the essential fields and behaviors of the data you’re storing. Django follows the DRY Principle.</p> 
                        <p>The goal is to define your data model in one place and automatically derive things from it.</p>
                        <p>Let's create a Django Model.</p>
                        <p>A database contains a number of variable which are represented by fields in django model.Each field is represented by an instance of a Field class – e.g., CharField for character fields and DateTimeField for datetimes. This tells Django what type of data each field holds.</p>
                        <pre>
from django.db import models


class PokemonTag(models.Model):
    tag = models.CharField(max_length=20)

    def __str__(self):
        return self.tag


class Pokemon(models.Model):
    pokemon_name = models.CharField(max_length=30)
    pokemon_url = models.CharField(max_length=30)
    pokemon_id = models.CharField(max_length=30, primary_key=True)
    pokemon_image_url = models.CharField(max_length=30)
    pokemon_tag = models.ManyToManyField(PokemonTag, related_name='pokemon')

    def __str__(self):
        return f"{self.pokemon_id}  {self.pokemon_name}"
                        </pre>
                        <p>Here, We have used the many to many relationship between the Pokemon and PokemonTag as there can be many tags for pokemon and vice versa.</p>
                        
                        <p><strong>Adding models to admin panel</strong></p>
                        <p>Django provides built-in admin panel to manage the data into model</p>
                        <pre>
from django.contrib import admin

# Register your models here.
from pokemon.models import Pokemon, PokemonTag

admin.site.register(Pokemon)
admin.site.register(PokemonTag)
                        </pre>



                        <h2 class="section-heading">Step 4 -> Importing pokemon data from json file using  Django Extensions(pokemon/script/load_pokemons.py)</h2>
                        <p><h3>Django EXtension</h3></p>
                        <p>It will help us to load data seamlessly without much manual work. It uses the JSON library to do the task. </p>
                        <pre>
import json
from pathlib import Path

from PokedexWithGraphene import settings
from pokemon.models import Pokemon, PokemonTag


def run(*args):
    file_path = Path(settings.BASE_DIR, 'pokemon/static/pokemon/pokemon.json')
    with open(file_path, encoding="utf8") as file:
        pokemon_data = json.loads(file.read())

    for pokemon in pokemon_data:
        pokemon_obj = Pokemon.objects.create(
            pokemon_url=pokemon["pokemon_url"],
            pokemon_name=pokemon["pokemon_name"],
            pokemon_id=pokemon["pokemon_id"],
            pokemon_image_url=pokemon["pokemon_image_url"]
        )
        pokemon_obj.pokemon_tag.add(*list(PokemonTag.objects.get_or_create(tag=pokemon)[0].id for pokemon in pokemon['pokemon_tags']))
        print(pokemon_obj.pokemon_id)
                        </pre>



                        <h2 class="section-heading">Step 5 -> Writing GraphQL queries and schema.</h2>
                        <pre>
import graphene
from graphene_django.types import DjangoObjectType

from .models import Pokemon, PokemonTag


class PokemonType(DjangoObjectType):
    class Meta:
        model = Pokemon
        field = '__all__'


class PokemonTagType(DjangoObjectType):
    class Meta:
        model = PokemonTag


class Query(graphene.ObjectType):
    all_pokemons = graphene.List(PokemonType)
    pokemon_by_id = graphene.Field(PokemonType,id=graphene.String(required=True))

    def resolve_all_pokemons(self, info, **kwargs):
        return Pokemon.objects.all()

    def resolve_pokemon_by_id(self,info,id):
        try:
            return Pokemon.objects.get(pokemon_id=id)
        except Pokemon.DoesNotExist:
            return 404


schema = graphene.Schema(query=Query)
                        </pre>
                        <p>We are using the GraghQl playground to get the right query to get the data.</p>
                        <a href="https://raw.githubusercontent.com/chaudharypraveen98/PokedexWithGraphene/master/graphql.JPG"><img class="img-fluid" src="https://raw.githubusercontent.com/chaudharypraveen98/PokedexWithGraphene/master/graphql.JPG" alt="GraghQl-image"></a>



                        <h2 class="section-heading">Step 6 -> Creating a view for handling the request made from the client.</h2>
                        <p><strong>What is a Django View?</strong></p>
                        <p>A view function, or view for short, is a Python function that takes a Web request and returns a Web response. </p>
                        <pre>

from django.shortcuts import render


# Create your views here.
def pokemon_home(request):
    return render(request, 'pokemon/pokemon_list.html')
                        </pre>

                        <p>We are using Django <tt>render</tt> in-built function.</p>
                        <p>The <tt>render()</tt>  function takes the request object as its first argument, a template name as its second argument and a dictionary as its optional third argument. It returns an <tt>HttpResponse</tt> object of the given template rendered with the given context.</p>
                        


                        <h2 class="section-heading">Step 7 -> Adding function handlers to routes.(PokedexWithGraphene/urls.py)</h2>
                        <p>Whenever user visit the user, a function is called in view which takes care of response.</p>
                        <pre>
"""PokedexWithGraphene URL Configuration"""
from django.conf.urls.static import static
from django.contrib import admin
from django.urls import path, include
from django.views.decorators.csrf import csrf_exempt
from graphene_django.views import GraphQLView

from PokedexWithGraphene import settings
from pokemon.schema import schema

urlpatterns = [
    path('admin/', admin.site.urls),
    path('graphql/', csrf_exempt(GraphQLView.as_view(
        graphiql=True, schema=schema
    ))),
    path('pokemons/', include('pokemon.urls'))
]
if settings.DEBUG:
    urlpatterns += static(settings.STATIC_URL,
                          document_root=settings.STATIC_ROOT)
    urlpatterns += static(settings.MEDIA_URL,
                          document_root=settings.MEDIA_ROOT)
                        </pre>

                        <p><b>Adding sub path for pokemon app</b></p>
                        <p>It defines the particular path for pokemon app</p>
                        <pre>
from django.urls import path

from pokemon import views

app = 'pokemom'

urlpatterns = [
    path('',views.pokemon_home),
                            ]
                        </pre>


                        <h2 class="section-heading">Step 8 -> Creating a Template for displaying the song data on the page</h2>
                        <p>We are using the jinja templating engine for displaying the data.</p>
                        <pre>
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Pokemon List&lt;/title&gt;
    {% load static %}
    &lt;link rel="stylesheet" href="{% static 'pokemon/style.css' %}"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt; class="head"&gt;Pokemon List&lt;/h1&gt;
    &lt;div&gt; class="pokemon-container card-group"&gt;
    &lt;/div&gt;
    &lt;script&gt; src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"&gt;&lt;/script&gt;
    &lt;script&gt; src="{% static 'pokemon/pokemon-list.js' %}"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
                        </pre>
                        <p><tt>&lt;script&gt; src="{% static 'pokemon/pokemon-list.js' %}"&gt;&lt;/script&gt;</tt> : - This script will fetch the data explained in next step</p>

                        <p><h2 class="section-heading">Step 9 -> Fetching data using ajax into templates</h2></p>
                        <p>Fetching data using the ajax call to the pokemon route <tt>127.0.0.1:8000/pokemons/</tt></p>
                        <p><b>pokemons/static/pokemon/pokemon-list.js</b></p>
                        <pre>
$(function () {

    'use strict';
    $.ajax({
        type: 'POST',
        url: '../graphql/',
        contentType: "application/json",
        data: JSON.stringify({
            query: "{  allPokemons{    pokemonId    pokemonUrl    pokemonName    pokemonImageUrl  pokemonTag{ tag }}}"
        }),
        success: function (data) {
            for (let i = 0; i &lt; data['data']['allPokemons'].length; i++) {
                const pokemon = data['data']['allPokemons'][i];
                $(".pokemon-container").append(`
                    &lt;div class="pokemon-card"&gt;
                        &lt;img src="${pokemon['pokemonImageUrl']}" class="card-img-top" alt="pokemon image"&gt;
                        &lt;div class="pokemon-body"&gt;
                            &lt;h5 class="pokemon-title"&gt;${pokemon['pokemonName']}&lt;/h5&gt;
                            &lt;h3 class="pokemon-id"&gt;${pokemon['pokemonId']}&lt;/h3&gt;
                            &lt;h4 class="pokemon-tags"&gt;${pokemon['pokemonTag'][0]['tag']}&lt;/h4&gt;                        
                        &lt;div class="pokemon-link"&gt;
                            &lt;a href="${pokemon['pokemonUrl']}" class="pokemon-button"&gt;More Details&lt;/a&gt;
                        &lt;div&gt;
                        &lt;/div&gt;
                        &lt;/div&gt;`
                );
            }
        },
        error: function (error_data) {
            console.log(error_data['responseText'])
        }
    })
});
                        </pre>

                        <p><strong>Add Some styles to make it attractive</strong></p>


                        <h2 class="section-heading">Deployment</h2>
                        <p>You can easily deploy on <a href="https://www.heroku.com/">Heroku</a></p>
                        <p>You can read more about on <a href="https://www.analyticsvidhya.com/blog/2020/10/step-by-step-guide-for-deploying-a-django-application-using-heroku-for-free/">Analytics Vidhya Blog</a></p>
                        
                        
                        <h2 class="section-heading">Web Preview / Output</h2>
                        <a href="https://raw.githubusercontent.com/chaudharypraveen98/PokedexWithGraphene/master/graphql3.JPG"><img class="img-fluid" src="https://raw.githubusercontent.com/chaudharypraveen98/PokedexWithGraphene/master/graphql3.JPG" alt="web preview" /></a>

                        <span class="caption text-muted">Web preview on deployment</span>
                        <p>
                            Placeholder text by
                            <a href="https://chaudharypraveen98.github.io/">Praveen Chaudhary</a>
                            &middot; Images by
                            <a href="hhttps://chaudharypraveen98.github.io/binarybeast/">Binary Beast</a>
                        </p>
                    </div>
                </div>
            </div>
        </article>
        <!-- Footer-->
        <footer class="border-top">
            <div class="container px-4 px-lg-5">
                <div class="row gx-4 gx-lg-5 justify-content-center">
                    <div class="col-md-10 col-lg-8 col-xl-7">
                        <ul class="list-inline text-center">
                            <li class="list-inline-item">
                                <a href="https://twitter.com/chaudhpraveen98">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://www.linkedin.com/in/chaudharypraveen98/">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                            <li class="list-inline-item">
                                <a href="https://github.com/chaudharypraveen98">
                                    <span class="fa-stack fa-lg">
                                        <i class="fas fa-circle fa-stack-2x"></i>
                                        <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                    </span>
                                </a>
                            </li>
                        </ul>
                        <div class="small text-center text-muted fst-italic">Copyright &copy; Praveen Chaudhary 2021</div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
